{% extends 'SnoutPage/base.html' %}
{% load staticfiles %}

{% block body_block %}
{% load socialaccount %}
{% get_social_accounts user as accounts %}
{% get_providers as socialaccount_providers %}


<div class="container-fluid" id = "user-page-top">


  <div class="row row-eq-height">
	<div class="panel panel-default" >
		<div id="blue-panel" class="panel-body">
			<div class="col-sm-5" style="background-color:skyblue;" id = "user-page-top-content">
	<div  id = "user-page-top-content" class = "well well-sm">
    {% load account %}
  {% if user.username == owner.username and accounts %} <!-- check if person viewing page is owner, and if so serve them their profile picture from fb -->
      <img src="{{owner.socialaccount_set.all.0.get_avatar_url }}" class="img-thumbnail" id = "user-page-avatarr" alt ="Profile Picture1" >

  {%else%}

  {%if owner.first_name %}


        <img src="{{ owner.socialaccount_set.all.0.get_avatar_url }}" class="img-thumbnail" id = "user-page-avatarr" alt ="Profile Picture" >
  {% else %}
  {% for i in imagedata %}
    {% if i.user == owner %}
      <img src = "{{i.image.url}}"class="img-thumbnail" id = "user-page-avatarr" alt ="Profile Picture" >
    {% endif %}
  {% endfor %}                    <!-- person is viewing another person's page - show them owner's profile picture -->
    {%endif%}
    {%endif%}

				<h1 id = "user-page-username">{{owner.username}}</h1>




				<!-- --------------------- IF user profile: --------------->
				{% if authenticated %}



									<a href="{% url 'add_pet' %}" class="btn btn-default btn-xs " type="button" >Add Pet</a>

				<div>
									<button class="btn btn-default btn-xs dropdown-toggle " type="button" data-toggle="dropdown">Edit User
										<span class="caret"></span></button>
											<ul class="dropdown-menu">
												<li><a href="{% url 'edit_user' %}">Edit login details</a></li>
													<li><a href = "{% url 'add_info' %}"> Add a Status</a></li>
                          {% if imagedata.image %}
                          {% else %}
													<li><a href="{% url 'add_image' %}">Add/Change profile picture</a></li>
                          {% endif %}

											</ul>


								</div>



	{% else %}

												<div>
							{% if not followed %}
							<form method='POST'>
							{{form.as_p}}
<<<<<<< HEAD
							<button type="submit"  name="follow" class="btn btn-success	 btn-xs"> follow</button>		
=======
							<button type="submit"  name="follow">follow</button>
>>>>>>> 1179c85139b10a0ea62e8b097642ec57c4ec502e
							</form>
							{% else %}
							<form method='POST'>
							{{form.as_p}}
<<<<<<< HEAD
							<button type="submit"  name="unfollow" class="btn btn-danger  btn-xs">unfollow</button>		
=======
							<button type="submit"  name="unfollow">unfollow</button>
>>>>>>> 1179c85139b10a0ea62e8b097642ec57c4ec502e
							</form>
							{% endif %}
							</div>
			  

				
{% endif %}
				</div>

			</div>

			<div class="col-sm-7" style="background-color:skyblue;" id= "user-page-top-content">



  <ul class="nav nav-tabs">
    <li class="active"><a data-toggle="tab" href="#Description">{{user.username}}'s status posts</a></li>
    <li><a data-toggle="tab" href="#Friends">Following<span class="badge"> {{followers.count}} </span></a></li> <!-- ----------------------- Number of friends -->
  </ul>

  <div class="tab-content" >
    <div id="Description" class="tab-pane fade in active">
	<div class="panel panel-default" id = "description-panel">
	 <div class="panel-body scrollable-panel" id = "description-scroll">
	<blockquote>
	{% for data in userdata reversed %}
{% if data.user == user.userprofile.user %}
	<h3> {{ data.description}} </h3>
	<h5> {{data.date}}</h5>
{% endif %}
{% endfor %}

	<!-- -----------------------------------------------------------------------User Description -->

  </blockquote>
  </div>
	</div>

    </div>
    <div id="Friends" class="tab-pane fade" id = "friends-tab">

{% if followers %}
   <div class="list-group">
    <div class="panel panel-default">
          <div class="panel-body scrollable-panel">
  
	 {% for user in followers %}
   
   

			 <a href="{% url 'user_page' user.username %}" class="list-group-item text-left"> <!-- ----------------------------------------------------------------------- Link to users page -->
		{% if follower.imagedata.image.url %}
		<img src = "{{user.imagedata.image.url}}" class = "img-thumbnail" id="search-user-img">			<!-- ------------------------------------------------------user image --> 
		{% else %}
        <img class="img-thumbnail" src="https://bootdey.com/img/Content/User_for_snippets.png"> 
		{% endif %}
        <label>
            {{follower.username}}<br> <!-- ----------------------------------------------------------------------- followee name -->
        </label>
		</a>
{% endfor %}





          </div> <!-- End of Scrollable panel -->
        </div>
   </div>
   
     {% else %}
	 <strong>You do not follow anyone.</strong>
	 {% endif %}
	</div>
    </div>

  </div>  <!-- ---------------- End of second col (desc/friends) -->
			</div>
		</div>
	</div>  <!-- ---------------- End of top row ------------------------------->


<div class="panel panel-default">
  <div class="panel-heading">User's Pets</div>
  <div class="panel-body">

  {% if pets %}
<div id="myCarousel" class="carousel slide" data-ride="carousel">

  <!-- Wrapper for slides -->
  <div class="carousel-inner">
{% for pet in pets %}
    {% if forloop.first %}
        <div class="active item">
    {% else %}
        <div class="item">
    {% endif %}

   {% if pet.picture %}
		<img class= "img img-rounded" src="{{pet.picture.url}}" alt="Picture of {{ pet.name }}"  href="{% url 'pet' pet.slug %}" id="carousel-pet-picture"> <!-- Pet's profile picture -->
    {%else %}

		<img src="{% static "images/logo.png" %}" alt="Picture of {{ pet.name }}"  href="{% url 'pet' pet.slug %}" id="carousel-pet-picture"> <!-- TEMP EXAMPLE, REMOVE WHEN PET PICRURES WORK -->
	{% endif %}

	  <div class="carousel-caption" id = "carousel-pet-name">
	  <blockquote>
        <h3><a href="{% url 'pet' pet.slug %}">{{ pet.name }}</a></h3> <!-- Pet's name -->
		<footer class="blockquote-footer"> {{pet.description}}</footer>
		 </blockquote>
      </div>

    </div>
{% endfor %}

</div>


  <!-- Left and right controls -->
  <a class="left carousel-control" href="#myCarousel" data-slide="prev">
    <span class="glyphicon glyphicon-chevron-left"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="right carousel-control" href="#myCarousel" data-slide="next">
    <span class="glyphicon glyphicon-chevron-right"></span>
    <span class="sr-only">Next</span>
  </a>
</div>
</div>
{% else %}
<h1 align="center"><mark>The user has no pets.<mark></h1>
{% endif %}

</div>
</div>

</div>



{% endblock %}
